---
- name: Cleanup envrioment
  hosts: master-1
  gather_facts: true
  tasks:
    - name: "Clean up global task"
      include_role:
        name: "k8s"  
        tasks_from: cleanup
    - name: "Clean runtime files"
      file:
        path: "{{ item }}"
        state: absent
      with_items:
            - /vagrant/k8s/templates/clean-istio.yaml
            - /vagrant/k8s/templates/cluster-with-secret-run.yaml
            - /vagrant/k8s/templates/keyfactor-secret-run.yaml
            - /vagrant/k8s/templates/single-cluster-run.yaml
            - /vagrant/k8s/templates/single-cluster-a-run.yaml
            - /vagrant/k8s/templates/single-cluster-b-run.yaml
            - /vagrant/k8s/templates/serviceentry-cluster-a-run.yaml 
            - /vagrant/k8s/templates/serviceentry-cluster-b-run.yaml 
            - /vagrant/k8s/templates/dns-a-run.yaml 
            - /vagrant/k8s/templates/dns-b-run.yaml
      changed_when: false